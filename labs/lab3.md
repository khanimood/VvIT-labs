# Лабораторная работа №3

Знакомство с основными средствами администрирования UNIX-подобных систем на примере дистрибутива Ubuntu Server.
Раскрытие команд командной оболочки.

## Рассматриваемые вопросы:

1. [Команды и аргументы](#1)
    * [Аргументы](#11)
        * [Удаление пробелов](#112) 
        * [Одинарные кавычки](#113)
        * [Двойные кавычки](#114)
        * [Команда `echo` и кавычки](#115)
    * [Команды](#12) 
        * [Команда `type`](#121)
        * [Исполнение внешних команд](#122)
        * [Команда `which`](#123)
    * [Псевдонимы команд](#13) 
        * [Создание псевдонима команды](#131)
        * [Сокращения команд](#132)
        * [Стандартные параметры команд](#133)
        * [Просмотр объявлений псевдонимов команд](#134)
        * [Команда `unalias`](#135)
2. [Операторы управления](#2)
   * [Точка с запятой (`;`)](#21)
   * [Амперсанд (`&`)](#22)
   * [Символ доллара со знаком вопроса (`$?`)](#23)
   * [Двойной амперсанд (`&&`)](#24)
   * [Двойная вертикальная черта (`||`)](#25)
   * [Комбинирование операторов `&&` и `||`](#26)
   * [Знак решетки (`#`)](#27)
   * [Экранирование специальных символов (`\`)](#28)
   * [Обратный слэш в конце строки](#29)

# Команды и аргументы <a name="1"></a>

## Аргументы <a name="11"></a>

Одной из важнейших возможностей командной оболочки является возможность обработки строк команд. При вводе команды после приглашения командной оболочки и нажатии клавиши Enter командная оболочка приступает к обработке строки команды, разделяя ее на аргументы. При обработке строки команды командная оболочка может внести множество изменений в переданные вами аргументы. Данный процесс называется раскрытием команд командной оболочки. После того, как командная оболочка заканчивает обработку и модификацию переданной строки команды, будет осуществляться непосредственное исполнение результирующей команды.

### Удаление пробелов <a name="111"></a>

Части строки команды, которые разделены с помощью одного или нескольких последовательно расположенных символов пробелов (или табуляции), рассматриваются как отдельные аргументы, причем все пробелы удаляются. Первым аргументом является сама команда, которая должна быть исполнена, остальные аргументы передаются этой команде. Фактически командная оболочка производит разделение вашей строки команды на один или несколько аргументов. Это полностью объясняет эквивалентность следующих четырех команд после их раскрытия средствами командной оболочки.

#### _Задание_:

Выполните следующие команды и убедитесь в их эквивалентности.

```
echo Hello World
echo Hello   World
echo   Hello   World
echo      Hello      World
```

### Одинарные кавычки <a name="112"></a>

Вы можете предотвратить удаление пробелов из строки команды, поместив ее в одинарные кавычки. Содержимое экранированной таким образом строки рассматривается как единый аргумент. В задании ниже команда `echo` принимает только один аргумент.

#### _Задание_:

Выполните следующую команду.

```
echo 'Строка с      одинарными    кавычками'
```

### Двойные кавычки <a name="113"></a>

Вы также можете предотвратить удаление пробелов из строки команды, поместив ее в двойные кавычки. Как и в задании выше, команда `echo` примет только один аргумент.

#### _Задание_:

Выполните следующую команду.

```
echo "Строка с      двойными    кавычками"
```

Позднее при рассмотрении переменных в рамках выполнения следующей лабораторной работы мы разберемся с важными различиями между одинарными и двойными кавычками.

### Команда `echo` и кавычки <a name="114"></a>

Строки, помещенные в кавычки, могут содержать специальные обозначения символов, идентифицируемые командной `echo` (в случае использования команды `echo -e`). В задании ниже продемонстрирована методика использования обозначения символа `\n` для вставки символа переноса строки, а также обозначения символа `\t` для вставки символа табуляции (обычно эквивалентного восьми символам пробела).

#### _Задание_:

Выполните следующие команды. Скриншот вывода поместите в отчет.

```
echo -e "Строка с \nсимволом переноса строки"
echo -e "Строка с \tсимволом табуляции"
```

Команда `echo` может генерировать и другие символы помимо символов пробелов, табуляции и переноса строки. Обратитесь к странице руководства (команда `man`) для ознакомления со списком допустимых обозначений символов.

## Команды <a name="12"></a>

Не все исполняемые командной оболочкой команды являются внешними; некоторые из них являются встроенными. Внешние команды реализованы в форме программ, представленных отдельными бинарными файлами, которые размещены в какой-либо директории файловой системы. Многие бинарные файлы, реализующие функции внешних команд, размещаются в директории `/bin` или `/sbin`. Встроенные команды являются неотъемлемой частью самого приложения командной оболочки.

### Команда `type` <a name="121"></a>

Для установления того, будет ли переданная командной оболочке команда исполнена как внешняя команда или как встроенная команда, следует использовать специальную команду `type`. Также вы можете использовать данную команду для установления того, является ли введенная команда псевдонимом команды.

#### _Задание_:

Определите тип (внешняя, встроенная или псевдоним) команд `cd`, `cat` и `ls`. Ответ поместите в отчет.

### Исполнение внешних команд <a name="122"></a>

Некоторые команды имеют как встроенные, так и внешние реализации. В случае исполнения одной из таких команд приоритет отдается встроенной реализации. Для исполнения внешней реализации вам придется ввести полный путь к бинарному файлу, являющемуся реализацией данной команды.

#### _Задание_:

Выполните следующие команды.

```
type -a echo
/bin/echo Исполнение внешней реализации команды echo...
```

### Команда `which` <a name="123"></a>

Команда `which` осуществляет поиск бинарных файлов в директории, заданной с помощью переменной окружения `$PATH` (переменные будут рассматриваться в следующей лабораторной работе).

#### _Задание_:

Выполните следующую команду.

```
which cp ls mkdir pwd
```

## Псевдонимы команд <a name="13"></a>

### Создание псевдонима команды <a name="131"></a>

Командная оболочка позволяет вам создавать псевдонимы команд (aliases). Псевдонимы команд обычно используются для создания лучше запоминающихся имен для существующих команд или для упрощения передачи параметров команд.

#### _Задание_:

Создайте текстовый файл с названием count.txt и напечатайте в нем следующий текст:

```
один
два
три
```

Выполните следующие команды. Скриншот вывода поместите в отчет.

```
cat count.txt
alias dog=tac
dog count.txt
```

### Сокращения команд <a name="132"></a>

Команда создания псевдонима команды `alias` также может оказаться полезной в случае необходимости сокращения длины имени существующей команды.

#### _Задание_:

Выполните следующие команды.

```
alias ll='ls -lh --color=auto'
alias c='clear'
```

### Стандартные параметры команд <a name="133"></a>

Псевдонимы команд могут использоваться для передачи командам стандартных параметров. В задании ниже показана методика передачи параметра `-i` по умолчанию при вводе команды `rm`.

#### _Задание_:

Создайте текстовый файл с названием foo.txt и напечатайте в нем произвольный текст. Выполните следующие команды. Скриншот вывода последней команды поместите в отчет.

```
rm -i foo.txt
no
rm foo.txt
ls foo.txt
touch foo.txt
alias rm='rm -i'
rm foo.txt
```

В некоторых дистрибутивах используются стандартные псевдонимы команд для защиты пользователей от случайного удаления файлов (`rm -i`, `mv -i`, `cp -i`).

### Просмотр объявлений псевдонимов команд <a name="134"></a>

Вы можете передать один или несколько псевдонимов команд в качестве аргументов команды `alias` для вывода их объявлений. Исполнение команды без аргументов приведет к выводу полного списка используемых на данный момент псевдонимов.

#### _Задание_:

Выполните следующую команду. Скриншот вывода поместите в отчет.

```
alias
```

### Команда `unalias` <a name="135"></a>

Также вы можете прекратить использование псевдонима команды, воспользовавшись командой `unalias`.

#### _Задание_:

Выполните следующие команды. Скриншот вывода поместите в отчет.

```
which rm
alias rm='rm -i'
which rm
unalias rm
which rm
```

# Операторы управления <a name="2"></a>

## Точка с запятой (`;`) <a name="21"></a>

Вы можете разместить две и более команд в одной и той же строке, разделив эти команды с помощью символа точки с запятой `;`. Командная оболочка будет исследовать строку команды до момента достижения символа точки с запятой. Все аргументы перед этим символом точки с запятой будут рассматриваться как аргументы, не относящиеся к команде, находящейся после символа точки с запятой. Все команды с наборами аргументов будут выполнены последовательно, причем командная оболочка будет ожидать завершения исполнения каждой из команд перед исполнением следующей команды.

### _Задание_:

Выполните следующие команды.

```
echo Hello
echo World
echo Hello ; echo World
```

## Амперсанд (`&`) <a name="22"></a>

В том случае, если строка команды оканчивается символом амперсанда `&`, командная оболочка не будет ожидать завершения исполнения этой команды. Сразу же после ввода команды будет выведено новое приглашение командной оболочки, а сама команда будет исполняться в фоновом режиме. В момент завершения исполнения команды в фоновом режиме вы получите соответствующее сообщение.

### _Задание_:

Выполните следующую команду. По истечении десяти секунд нажмите клавишу Enter. Скриншот вывода поместите в отчет.

```
sleep 10 &
```

Технические подробности выполняющихся при использовании рассматриваемого оператора операций будут рассматриваться в лабораторной работе, посвященной процессам.

## Символ доллара со знаком вопроса (`$?`) <a name="23"></a>

Код завершения предыдущей команды сохраняется в переменной командной оболочки с именем `$?`. На самом деле `$?` является параметром командной оболочки, а не ее переменной, так как вы не можете присвоить значение переменной `$?`.

### _Задание_:

Выполните следующие команды. Скриншот вывода поместите в отчет.

```
touch file1
echo $?
rm file1
echo $?
rm file1
echo $?
```

## Двойной амперсанд (`&&`) <a name="24"></a>

Командная оболочка будет интерпретировать последовательность символов `&&` как логический оператор "И". При использовании оператора `&&` вторая команда будет исполняться только в том случае, если исполнение первой команды успешно завершится (будет возвращен нулевой код завершения).

### _Задание_:

Выполните следующие команды. Скриншот вывода поместите в отчет.

```
echo первая команда && echo вторая команда
zecho первая команда && echo вторая команда
```

## Двойная вертикальная черта (`||`) <a name="25"></a>

Оператор `||` представляет логическую операцию "ИЛИ". Вторая команда исполняется только тогда, когда исполнение первой команды заканчивается неудачей (возвращается ненулевой код завершения).

### _Задание_:

Выполните следующие команды. Скриншот вывода поместите в отчет.

```
echo первая команда || echo вторая команда ; echo третья команда
zecho первая команда || echo вторая команда ; echo третья команда
```

## Комбинирование операторов `&&` и `||` <a name="26"></a>

Вы можете использовать описанные логические операторы "И" и "ИЛИ" для создания структур условных переходов в рамках строк команд. В данном задании используется команда echo для вывода информации о том, успешно ли отработала команда rm.

### _Задание_:

Создайте пустой файл с названием file1. Выполните следующие команды. Скриншот вывода поместите в отчет.

```
rm file1 && echo Команда сработала! || echo Исполнение команды завершилось неудачей!
rm file1 && echo Команда сработала! || echo Исполнение команды завершилось неудачей!
```

## Знак решетки (`#`) <a name="27"></a>

Все написанное после символа решетки (`#`) игнорируется командной оболочкой. Это обстоятельство оказывается полезным при возникновении необходимости в написании комментариев в сценариях командной оболочки, причем комментарии ни коим образом не будут влиять на процесс исполнения команд или процесс раскрытия команд командной оболочкой.

### _Задание_:

Выполните следующие команды.

```
mkdir test # создаем директорию
cd test #### переходим в эту директорию
ls # пуста ли она ?
```

## Экранирование специальных символов (`\`) <a name="28"></a>

Символ обратного слэша `\` позволяет использовать управляющие символы без их интерпретации командной оболочкой; процедура добавления данного символа перед управляющими символами называется экранированием символов.

```
echo hello \; world
echo hello\ \ \ world
echo экранирование \\\ \#\ \&\ \"\ \'
echo экранирование \\\?\*\"\'
```

## Обратный слэш в конце строки <a name="29"></a>

Строка команды, заканчивающаяся обратным слэшем, продолжается в следующей строке. Командная оболочка не будет интерпретировать символы перехода на новые строки и отложит исполнение операции раскрытия команды и ее исполнение до момента чтения новой строки команды без обратного слэша в конце.

### _Задание_:

Выполните следующую команду. Скриншот вывода поместите в отчет.

```
echo Данная строка команды \
> разделена на три \
> части
```
