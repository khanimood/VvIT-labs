# Лабораторная работа №1

Знакомство с основными средствами администрирования UNIX-подобных систем на примере дистрибутива Ubuntu Server 20.04.

### Рассматриваемые вопросы:

1. Страницы мануалов по командам.
2. Работа с директориями.
3. Дерево директорий Linux.

## Инициализация рабочего окружения

1. Склонировать данный репозиторий на рабочую машину.
2. На [сайте](https://www.virtualbox.org/wiki/Download) скачать последнюю версию гипервизора VirtualBox для своей операционной системы.
3. На [сайте](https://www.vagrantup.com/) скачать последнюю версию ПО для управления виртуализацией vagrant.
4. Запустить консоль (CLI) и перейти в локальный репозиторий.
5. Создать и сконфигурировать виртуальную машину `vagrant up`. Username: vagrant, password: vagrant.
6. Подключиться к виртуальной машине по ssh - `vagrant ssh`.
7. _Задание повышенной сложности._ Ознакомьтесь с Vagrantfile. Попробуйте создать виртуальную машину с 4 ГБ RAM и 4 CPU.

## Страницы руководств `man`

Большинство файлов и утилит в системах Unix имеет отличные страницы руководств с пояснениями относительно их использования. Страницы руководств становятся особенно полезными в тех случаях, когда вы используете множество различных разновидностей систем Unix или несколько дистрибутивов Linux, так как опции и параметры используемых в них приложений иногда отличаются.

### Команды `man {$команда|$имя_файла_конфигурации|$демон`

Вы можете ввести команду `man` с последующим именем интересующей команды (для которой вам хотелось бы получить справочную информацию) и начать чтение страницы руководства. Нажмите q для выхода из режима чтения страницы руководства. Некоторые страницы руководств содержат примеры (расположенные ближе к концу страницы).  
Для большинства файлов конфигурации имеются отдельные страницы руководств.  
Также данное утверждение справедливо для большинства демонов (программ, работающих в фоновом режиме) из вашей системы.

### Команда `man -k` (`apropos`)

Команда `man -k` (или `apropos`) позволяет вывести список страниц руководств, содержащих заданную строку.

### Номера справочных разделов

Вы, скорее всего, обратили внимание на числа в круглых скобках. Выполнив команду `man man`, вы можете узнать о том, что эти числа являются номерами справочных разделов. Исполняемые файлы и команды оболочки отнесены к первому справочному разделу.  
| Раздел | Содержание |
| --- | ---|
| 1 | Пользовательские команды и приложения |
| 2 | Системные вызовы (функции, предоставляемые ядром) и коды ошибок ядра |
| 3 | Библиотечные вызовы (функции, предоставляемые программными библиотеками) |
| 4 | Драйверы устройств и сетевые протоколы |
| 5 | Стандартные форматы файлов |
| 6 | Игры и демонстрации |
| 7 | Разное (включает пакеты макросов и соглашения) |
| 8 | Команды администрирования системы |
| 9 | Спецификации ядра и интерфейсы |

При обращении к странице руководства для команды passwd, вы можете обнаружить, что эта страница обозначается как `passwd(1)`; при обращении к странице руководства для файла `passwd` используется обозначение `passwd(5)`. Приведенные ниже примеры команд иллюстрируют методику открытия страниц руководств из корректных разделов.

```
man passwd      # открывает первую найденную страницу руководства
man 5 passwd    # открывает страницу руководства из раздела 5
```

### _Задание_

1. Ознакомиться со справкой по команде `cd` (`help cd`).
2. Ознакомиться с мануалом по командам `ls`, `ifconfig`. Краткое пояснение назначения команд `cd` и `ls` поместить в отчет.
3. Поиск мануалов по ключу (`-k`): http, ssh и т.п.
4. Что делает команда `whatis`? Краткое пояснение назначения команды поместить в отчет.

## Работа с директориями

### Команда `pwd`

С помощью команды `pwd` (расшифровывается как Print Working Directory - вывести информацию о рабочей директории) может быть получена информация о вашем текущем местонахождении в рамках файловой системы.

### Команда `cd`

Вы можете изменить вашу текущую директорию с помощью команды `cd` (расшифровывается как Change Directory - изменить директорию).

#### Команда `cd ~`

Команда `cd` также может использоваться для быстрого перехода назад в вашу домашнюю директорию. Простое исполнение команды `cd` без задания пути к целевой директории приведет к перемещению в домашнюю директорию. Исполнение команды `cd ~` приведет к аналогичному эффекту.

#### Команда `cd ..`

Для перехода в родительскую директорию (ту директорию, которая находится над вашей текущей директорией в дереве директорий) следует использовать команду `cd ..` .

#### Команда `cd -`

Другой полезный вариант использования команды `cd` заключается в выполнении простой команды `cd -` для перехода в предыдущую директорию.

### Абсолютные и относительные пути

Вы должны иметь представление об абсолютных и относительных путях в рамках дерева директорий файловой системы. Если вы вводите путь, начинающийся с символа слэша (`/`), подразумевается, что путь будет указан относительно корневой директории файловой системы. Если же вы не начинаете ввод пути с символа слэша, подразумевается, что точкой отсчета будет текущая директория.

### Завершение путей

Клавиша TAB может помочь избежать ошибок при вводе путей. Нажатие клавиши TAB после ввода части команды `cd /et` приведет к завершению команды до вида `cd /etc/`. При этом нажатие клавиши TAB после ввода команды `cd /Et` не приведет ни к чему, так как была допущена ошибка при вводе части пути (использована буква E в верхнем регистре).

### Утилита `ls`

Вы можете вывести список содержимого директории с помощью утилиты `ls`.

#### Команда `ls -a`

Часто используемым параметром утилиты `ls` является параметр `-a`, который предназначен для вывода информации обо всех файлах. Под выводом информации обо всех файлах подразумевается вывод информации в том числе и о скрытых файлах. В том случае, если имя файла в рамках файловой системы Linux начинается с символа точки, он считается скрытым файлом и не включается в обычные списки содержимого директорий.

#### Команда `ls -l`

Вам придется многократно использовать параметры утилиты `ls` для вывода информации о содержимом директории в различных форматах или для вывода информации о различных файлах из директории. Команда `ls` без параметров позволяет получить список файлов, расположенных в директории. Команда `ls -l` позволяет получить более подробный список файлов.

#### Команда `ls -lh`

Другим периодически используемым параметром утилиты `ls` является параметр `-h`. Он позволяет выводить числовые значения (соответствующие размерам файлов) в формате, лучше читаемом человеком (human readable).

### Утилита `mkdir`

Обход дерева директорий файловой системы Unix является интересным занятием, но еще больший интерес представляет создание ваших собственных директорий с помощью утилиты `mkdir`. Вам придется передавать как минимум один параметр утилите `mkdir`, а именно, имя новой директории, которая должна быть создана.

#### Команда `mkdir -p`

В случае использования параметра `-p` утилиты `mkdir` при необходимости будут создаваться родительские директории.

### Утилита `rmdir`

В том случае, если директория пуста, вы можете использовать утилиту `rmdir` для удаления этой директории.

#### Команда `rmdir -p`

И по аналогии с параметром `mkdir -p`, вы также можете использовать утилиту `rmdir` для рекурсивного удаления директорий.

### _Задание_

1. Вывести список содержимого корневой директории с различными параметрами (`-a/-l/-h` и их комбинации). Скриншот вывода поместить в отчет.
2. Перейти в домашнюю директорию. Следующие задания выполняются в ней.
3. Создать директорию `~/testdir`.
4. Создать директорию `~/tesdir2/testdir3` (при помощи параметра `-p`).
5. Вывести список содержимого домашней директории. Скриншот вывода поместить в отчет.
6. Удалить директорию `~/testdir` при помощи утилиты rmdir.
7. Удалить директорию `~/tesdir2/testdir3` (при помощи параметра -p).

## Дерево директорий Linux

Файловые системы в системе UNIX никогда не были хорошо организованы. В ней одновременно используется много разных, несовместимых соглашений об именовании файлов. Во многих случаях файлы группируются по выполняемым функциям, независимо от того, как часто они изменяются. Это затрудняет обновление операционной системы. Например, каталог `/etc` содержит ряд файлов, которые никогда не меняются, а также локальные файлы. Как определить, какие файлы нельзя трогать при обновлении системы? Это нужно просто знать… или верить, что программа инсталляции примет правильные решения.  
Корневая файловая система содержит корневой каталог и минимальный набор файлов и подкаталогов. Файл ядра находится в недрах корневой файловой системы, но не имеет стандартного имени или точного местоположения для разных дистрибутивов.  
Частью корневой файловой системы являются также каталог `/etc` для критических системных файлов и файлов конфигурации, каталоги `/sbin` и `/bin` - для важных утилит и иногда каталог `/tmp` - для временных файлов. В прошлом каталог `/dev` представлял собой реальный каталог, включенный в корневую файловую систему, но сейчас он является виртуальной файловой системой, которая монтируется отдельно.  
Одни системы хранят совместно используемые библиотечные файлы и прочие важные программы (например, препроцессор языка С) в каталоге `/lib` или `/lib64`. Другие переместили эти элементы в каталог `/usr/lib`, оставив для каталога `/lib` роль символической ссылки.  
Огромное значение имеют также каталоги `/usr` и `/var`. В первом хранится большинство стандартных программ и другие полезные компоненты. Совсем не обязательно, чтобы каталог `/usr` был отдельной файловой системой, однако для удобства администрирования его, как правило, монтируют именно так. Для того чтобы система могла загружаться в многопользовательском режиме, необходимы оба каталога - `/usr` и `/var`.  
В прошлом было принято разбивать системный диск на разделы и размещать в них отдельные части файлового дерева (в основном в каталогах `/usr`, `/var` и `/tmp`). Эта практика не исчезла полностью и в настоящее время, но основной тенденцией стало использование одной большой корневой файловой системы. Большие жесткие диски и возрастающая сложность реализаций файловых систем снизили ценность разбиения дисков на разделы.  
Чаще всего разбиение диска используют для того, чтобы одна часть файлового дерева не занимала все доступное пространство и не вызывала сбой системы. Соответственно, чаще всего разбиению подвергаются каталог `/var` (содержащий файлы журнала, размеры которых со временем растут и могут вызвать проблемы), `/tmp` и рабочие каталоги пользователей. Специальные файловые системы могут хранить большие объемы информации, например библиотеки исходных кодов и базы данных.
Наиболее важные стандартные каталоги перечислены в приведенной ниже таблице.

| Каталог        | Содержимое                                                                                                                   |
| -------------- | ---------------------------------------------------------------------------------------------------------------------------- |
| /bin           | Команды операционной системы ядра                                                                                            |
| /boot          | Ядро и файлы для его загрузки                                                                                                |
| /dev           | Файлы устройств: дисков, принтеров, псевдотерминалов и т.д.                                                                  |
| /etc           | Важные файлы запуска и конфигурации системы                                                                                  |
| /home          | Стандартные домашние каталоги пользователей                                                                                  |
| /lib           | Библиотеки, совместно используемые библиотеки и команды, применяемые в каталогах `/bin` и `/sbin`                            |
| /media         | Точки монтирования файловых систем на съемных носителях                                                                      |
| /mnt           | Временные точки монтирования                                                                                                 |
| /opt           | Программные пакеты необязательных приложений (которые пока не находят широкого применения)                                   |
| /proc          | Информация о всех выполняющихся процессах                                                                                    |
| /root          | Домашний каталог суперпользователя (часто просто `/`)                                                                        |
| /run           | Точки встречи для выполняемых программ (идентификаторы PID, сокеты и т.д.)                                                   |
| /sbin          | Команды, необходимые для обеспечения минимальной работоспособности системы [^1]                                              |
| /srv           | Поля, зарезервированные для распределения через веб и другие серверы                                                         |
| /sys           | Интерфейсы разных ядер                                                                                                       |
| /tmp           | Временные файлы, которые могут удаляться при перезагрузке                                                                    |
| /usr           | Иерархия дополнительных файлов и программ                                                                                    |
| /usr/bin       | Большинство команд и исполняемых файлов                                                                                      |
| /usr/include   | Файлы заголовков, предназначенные для компиляции С-программ                                                                  |
| /usr/lib       | Библиотеки и вспомогательные файлы для стандартных программ                                                                  |
| /usr/local     | Локальные программы (программы, создаваемые или устанавливаемые локальным пользователем); отражает структуру каталога `/usr` |
| /usr/sbin      | Менее важные команды системного администрирования                                                                            |
| /usr/share     | Элементы, общие для различных систем                                                                                         |
| /usr/share/man | Страницы интерактивной документации                                                                                          |
| /usr/src       | Исходные коды нелокальных программных пакетов (не находит широкого применения)                                               |
| /usr/tmp       | Дополнительный каталог для временных файлов, которые могут сохраняться при перезагрузке                                      |
| /var           | Системные данные и конфигурационные файлы                                                                                    |
| /var/adm       | Разное: журнальные файлы, записи об инсталляции системы, административные компоненты                                         |
| /var/log       | Системные журнальные файлы                                                                                                   |
| /var/run       | Те же функции. что и в каталоге `/run`, а также символические ссылки                                                         |
| /var/spool     | Буферные каталоги для принтеров, электронной почты и т.д.                                                                    |
| /var/tmp       | Каталог для временного хранения файлов (после перезагрузки файлы не исчезают)                                                |

[^1]: В прошлом отличительная особенность команд в каталоге `/sbin` обычно состояла в том, что они связаны со статическими версиями системных библиотек и, следовательно, не имеют многочисленных зависимостей от других частей системы. В настоящее время все бинарные модули связаны динамически и поэтому между каталогами `/bin` и `/sbin` реальной разницы нет.

### Стандарт иерархии файловой системы

Многие дистрибутивы Linux частично следуют Стандарту иерархии файловой системы (Filesystem Hierarchy Standard). Данный стандарт может оказаться полезным для будущего процесса стандартизации деревьев директорий файловых систем Unix/Linux. Стандарт FHS доступен в сети по адресу <http://www.pathname.com/fhs/>, причем на данном ресурсе мы можем прочитать: "Стандарт иерархии файловой системы был создан с целью его использования разработчиками дистрибутивов Unix, разработчиками пакетов для распространения программного обеспечения и разработчиками операционных систем. Однако, данный стандарт является в большей степени справочным материалом, нежели руководством по работе с файловой системой Unix или с иерархиями директорий."

### Страница руководства `man hier`

Существуют некоторые различия в иерархиях файловых систем различных дистрибутивов Linux. Для того, чтобы ознакомиться с информацией об иерархии файловой системы вашей машины, используйте команду `man hier`. На данной странице руководства будут приведены пояснения относительно структуры дерева директорий системы, установленной на вашем компьютере.

### _Задание_

1. Ознакомиться с иерархией файловой системы рабочей машины.
2. В какой директории лежат исполняемые файлы. Ответ указать в отчете.
3. В какой директории лежат файлы устройств. Ответ указать в отчете.
4. В какой директории лежат файлы загрузчика. Ответ указать в отчете.
